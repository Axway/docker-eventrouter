instance_id: "$ER_INSTANCE_ID"
streams:
  - name: "QLT_input"
    disable: false
    description: "QLT to file"
    upstream: ""
    reader:
      type: qlt-server-reader
      conf:
        port: 1325
        # cert: $ER_QLT_SERVER_CERT
        # certKey: $ER_QLT_SERVER_KEY
    writer:
      type: file-writer
      conf:
        filenamePrefix: "data/qlt-messages"
        filenameSuffix: "xml"
        maxSize: 100  # Integer: number of MBytes, the minimum size is 1 MB
        maxFile: 5    # Integer: number of files used by the writer, when
                      # this number is reached the oldest file will be erased
                      # so that a new one will be created.
                      # Value 0 equals to no limit
  - name: "QLT_out_ER"
    disable: false
    description: "file to QLT Event Router"
    upstream: "QLT_input"
    reader:
      type: file-reader
      conf:
        filenamePrefix: "data/qlt-messages"
        filenameSuffix: "xml"
        readerFilename: "data/qlt-messages.QLT_out_ER.cursor"
    writer:
      type: qlt-client-writer
      conf:
        addresses: "addr:port"
        cnx: 1
        # ca: $ER_QLT_SERVER_CA
  - name: "QLT_out_Sentinel"
    disable: true
    description: "file to QLT Sentinel"
    upstream: QLT_input
    reader:
      type: file-reader
      conf:
        filenamePrefix: "data/qlt-messages"
        filenameSuffix: "xml"
        readerFilename: "data/qlt-messages.QLT_out_Sentinel.cursor"
    writer:
      type: "qlt-client-writer"
      conf:
        addresses: "sentinel.domain.int:1305"
        synchronous: true # needed if target is Sentinel
        cnx: 1
        # ca: $ER_SENTINEL_CA
  - name: "Kafka_out"
    disable: true
    description: "file to Kafka topic"
    upstream: "QLT_input"
    reader:
      type: file-reader
      conf:
        filenamePrefix: "data/qlt-messages"
        filenameSuffix: "xml"
        readerFilename: "data/qlt-messages.Kafka_out.cursor"
    transforms:
      - type: qlt2json
    writer:
      type: kafka-writer
      conf:
        addresses: "addr:port"
        topic: "Kafka_out"
        # ca: $ER_KAFKA_SERVER_CA
        # cert: $ER_KAFKA_CLIENT_CERT
        # certKey: $ER_KAFKA_CLIENT_KEY
        # user:
        # password:
        # saslType:
  - name: "TransformXMLToJson"
    disable: true
    description: "converts QLT XML messages to JSON format"
    upstream: "QLT_input"
    reader:
      type: file-reader
      conf:
        filenamePrefix: "data/qlt-messages"
        filenameSuffix: "xml"
        readerFilename: "data/qlt-messages.TransformXMLToJson.cursor"
    transforms:
      - type: qlt2json
    writer:
      type: file-writer
      conf:
        filenamePrefix: "data/qlt-messages"
        filenameSuffix: "json"
        maxSize: 100
        maxFile: 5
